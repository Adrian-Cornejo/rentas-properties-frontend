<div class="form-container">
  <!-- Header -->
  <div class="form-header">
    <div class="header-left">
      <button class="btn-back" (click)="cancel()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="m15 18-6-6 6-6"/>
        </svg>
      </button>
      <div class="header-title-section">
        <h1 class="form-title">{{ isEditing() ? 'Editar Inquilino' : 'Nuevo Inquilino' }}</h1>
        <p class="form-subtitle">{{ isEditing() ? 'Actualiza la información del inquilino' : 'Registra un nuevo inquilino en el sistema' }}</p>
      </div>
    </div>
  </div>

  <!-- Tabs -->
  <div class="form-content">
    <div class="tabs">
      <button
        class="tab-button"
        [class.active]="activeTab() === 'basic'"
        (click)="setActiveTab('basic')">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/>
          <circle cx="12" cy="7" r="4"/>
        </svg>
        <span class="tab-text">Información Básica</span>
      </button>

      <button
        class="tab-button"
        [class.active]="activeTab() === 'documents'"
        (click)="setActiveTab('documents')">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
          <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
        </svg>
        <span class="tab-text">Documentos</span>
      </button>

      <button
        class="tab-button"
        [class.active]="activeTab() === 'notes'"
        (click)="setActiveTab('notes')">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
          <polyline points="14 2 14 8 20 8"/>
          <line x1="16" x2="8" y1="13" y2="13"/>
          <line x1="16" x2="8" y1="17" y2="17"/>
          <line x1="10" x2="8" y1="9" y2="9"/>
        </svg>
        <span class="tab-text">Notas</span>
      </button>
    </div>

    <form [formGroup]="tenantForm" (ngSubmit)="saveTenant()">
      <!-- Tab 1: Basic Information -->
      <div class="tab-content" *ngIf="activeTab() === 'basic'">
        <div class="form-row">
          <div class="form-group full-width">
            <label for="fullName">Nombre Completo *</label>
            <input
              id="fullName"
              type="text"
              formControlName="fullName"
              placeholder="Nombre completo del inquilino">
            <span class="error-message" *ngIf="tenantForm.get('fullName')?.invalid && tenantForm.get('fullName')?.touched">
              El nombre es requerido (mínimo 3 caracteres)
            </span>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="phone">Teléfono *</label>
            <input
              id="phone"
              type="tel"
              formControlName="phone"
              placeholder="5512345678"
              maxlength="10">
            <span class="error-message" *ngIf="tenantForm.get('phone')?.invalid && tenantForm.get('phone')?.touched">
              Teléfono inválido (10 dígitos)
            </span>
          </div>

          <div class="form-group">
            <label for="email">Email</label>
            <input
              id="email"
              type="email"
              formControlName="email"
              placeholder="correo@ejemplo.com">
            <span class="error-message" *ngIf="tenantForm.get('email')?.invalid && tenantForm.get('email')?.touched">
              Email inválido
            </span>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Número de Ocupantes *</label>
            <div class="occupants-control">
              <button type="button" class="btn-circle" (click)="decrementOccupants()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M5 12h14"/>
                </svg>
              </button>
              <input
                type="number"
                formControlName="numberOfOccupants"
                class="occupants-input"
                readonly>
              <button type="button" class="btn-circle" (click)="incrementOccupants()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 5v14M5 12h14"/>
                </svg>
              </button>
            </div>
            <small class="help-text">Número de personas que ocuparán la propiedad</small>
          </div>
        </div>
      </div>

      <!-- Tab 2: Documents -->
      <div class="tab-content" *ngIf="activeTab() === 'documents'">
        <div class="documents-section">
          <h3 class="section-title">Identificación Oficial (INE/IFE)</h3>
          <p class="section-description">Sube una imagen de la identificación oficial del inquilino</p>

          <div class="form-row">
            <div class="form-group">
              <label for="ineNumber">Número de INE</label>
              <input
                id="ineNumber"
                type="text"
                formControlName="ineNumber"
                placeholder="IDMEX1234567890">
            </div>
          </div>

          <!-- INE Image Upload -->
          <div class="ine-upload-section">
            <div class="ine-preview" *ngIf="ineImageUrl()">
              <img [src]="ineImageUrl()" alt="INE Preview">
              <button
                type="button"
                class="btn-remove-image"
                (click)="removeINEImage()"
                title="Eliminar imagen">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M18 6 6 18M6 6l12 12"/>
                </svg>
              </button>
            </div>

            <div class="ine-upload-placeholder" *ngIf="!ineImageUrl()">
              <label class="upload-label">
                <input
                  type="file"
                  accept="image/*"
                  (change)="onFileSelected($event)"
                  style="display: none;">
                <div class="upload-content">
                  <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
                    <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
                  </svg>
                  <p class="upload-text">
                    {{ isUploadingINE() ? 'Subiendo imagen...' : 'Click para subir imagen de INE' }}
                  </p>
                  <p class="upload-hint">PNG, JPG (máx. 5MB)</p>
                </div>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab 3: Notes -->
      <div class="tab-content" *ngIf="activeTab() === 'notes'">
        <div class="notes-section">
          <label class="notes-label">Notas Adicionales</label>
          <div class="textarea-wrapper">
            <textarea
              formControlName="notes"
              placeholder="Información adicional sobre el inquilino..."
              maxlength="500"
              rows="12"></textarea>
            <span class="char-counter">{{ getCharCount() }}/500</span>
          </div>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <button
          type="button"
          class="btn btn-secondary"
          (click)="cancel()"
          [disabled]="isSaving()">
          Cancelar
        </button>
        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="isSaving() || tenantForm.invalid">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" *ngIf="!isSaving()">
            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
            <polyline points="17 21 17 13 7 13 7 21"/>
            <polyline points="7 3 7 8 15 8"/>
          </svg>
          {{ isSaving() ? 'Guardando...' : (isEditing() ? 'Actualizar Inquilino' : 'Crear Inquilino') }}
        </button>
      </div>
    </form>
  </div>
</div>
